<div class="menu-toggle" (click)="toggleMenu()">
  <i class="fas fa-bars"></i>
</div>

<aside class="menu-lateral" [class.active]="menuActive">
  <div class="menu-header"><h2>Menú</h2></div>
  <ul class="menu-items" *ngIf="isGerente">
    <li><a routerLink="/dashboard"><i class="fas fa-home"></i> Inicio</a></li>
    <li><a routerLink="/ver-productos-geren"><i class="fas fa-eye"></i> Ver Productos</a></li>
    <li>
      <a (click)="toggleMovimientos()"><i class="fas fa-exchange-alt"></i> Movimientos</a>
      <ul class="submenu" [class.active]="movimientosActive">
        <li><a routerLink="/entrada-productos">Entrada</a></li>
        <li><a routerLink="/salida-producto">Salida</a></li>
      </ul>
    </li>
    <li><a routerLink="/reporte-ventas"><i class="fas fa-chart-line"></i> Reportes de Ventas</a></li>
    <li>
      <a (click)="toggleNomina()"><i class="fas fa-money-check"></i> Nómina</a>
      <ul class="submenu" [class.active]="nominaActive">
        <li><a routerLink="/bono-extras-nom"><i class="fas fa-gift"></i> Bonos y Horas Extras</a></li>
        <li><a routerLink="/calcular-nomina"><i class="fas fa-calculator"></i> Cálculo Nómina</a></li>
        <li><a routerLink="/descuentos-nom"><i class="fas fa-hand-holding-usd"></i> Descuentos</a></li>

      </ul>
    </li>
    <li><a routerLink="/cuentas-empleadoss"><i class="fas fa-users-cog"></i> Cuentas de Empleados</a></li>
    <li><a (click)="logout()"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
  </ul>
</aside>

<main class="contenido-principal">
  <!-- HEADER CON LOGO GRANDE Y BIEN SEPARADO -->
  <header class="main-header">
    <h1>CarniTrack</h1>
  </header>

  <section class="bonos-extras-modern">
    <div class="page-header">
      <h2>Asignar Bonos y Horas Extras</h2>
      <p class="subtitle">Registra incentivos y horas adicionales de forma rápida</p>
    </div>

    <div class="cards-container">
      <!-- CARD BONO -->
      <div class="card bono-card">
        <div class="card-header">
          <i class="fas fa-gift"></i>
          <h3>Asignar Bono</h3>
        </div>
        <form (ngSubmit)="asignarBono()" class="modern-form">
          <div class="input-group">
            <label>Empleado</label>
            <select [(ngModel)]="bono.empleado_id" name="empleado_id" required>
              <option value="" disabled selected>Selecciona un empleado</option>
              <option *ngFor="let e of empleados" [value]="e.id">{{ e.id }} - {{ e.nombre }}</option>
            </select>
          </div>

          <div class="input-row">
            <div class="input-group">
              <label>Monto</label>
              <input type="number" step="0.01" [(ngModel)]="bono.monto" name="monto" placeholder="0.00" required>
            </div>
            <div class="input-group">
              <label>Motivo</label>
              <select [(ngModel)]="bono.motivo" name="motivo" required>
                <option value="" disabled selected>Selecciona motivo</option>
                <option value="Productividad">Productividad</option>
                <option value="Puntualidad">Puntualidad</option>
                <option value="Ventas Altas">Ventas Altas</option>
                <option value="Limpieza">Limpieza</option>
                <option value="Atención al Cliente">Atención al Cliente</option>
                <option value="Responsabilidad">Responsabilidad</option>
                <option value="Otro">Otro</option>
              </select>
            </div>
          </div>

          <div class="input-group">
            <label>Fecha</label>
            <input type="date" [(ngModel)]="bono.fecha" name="fecha" [max]="hoy" required>
          </div>

          <button type="submit" class="btn-primary">
            <i class="fas fa-check"></i> Asignar Bono
          </button>
        </form>
      </div>

      <!-- CARD HORAS EXTRAS -->
      <div class="card hex-card">
        <div class="card-header">
          <i class="fas fa-clock"></i>
          <h3>Horas Extras</h3>
        </div>
        <form (ngSubmit)="registrarHorasExtras()" class="modern-form">
          <div class="input-group">
            <label>Empleado</label>
            <select [(ngModel)]="hex.empleado_id" name="empleado_id_hex" required>
              <option value="" disabled selected>Selecciona un empleado</option>
              <option *ngFor="let e of empleados" [value]="e.id">{{ e.id }} - {{ e.nombre }}</option>
            </select>
          </div>

          <div class="input-row">
            <div class="input-group">
              <label>Horas</label>
              <input type="number" min="1" max="12" [(ngModel)]="hex.horas" name="horas" required>
            </div>
            <div class="input-group">
              <label>Fecha</label>
              <input type="date" [(ngModel)]="hex.fecha" name="fecha_hex" [max]="hoy" required>
            </div>
          </div>

          <button type="submit" class="btn-primary">
            <i class="fas fa-clock"></i> Registrar Horas Extras
          </button>
        </form>
      </div>
    </div>

    <!-- HISTORIAL -->
    <div class="history-section" *ngIf="registros.length > 0">
      <h3><i class="fas fa-history"></i> Historial Reciente</h3>
      <div class="table-responsive">
        <table class="modern-table">
          <thead>
            <tr>
              <th>Tipo</th>
              <th>Empleado</th>
              <th>Descripción</th>
              <th>Cantidad</th>
              <th>Fecha</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of registros">
              <td>
                <span class="badge" [class.badge-bono]="r.tipo==='Bono'" [class.badge-hex]="r.tipo==='Horas Extras'">
                  <i [class]="'fas fa-' + (r.tipo==='Bono' ? 'gift' : 'clock')"></i>
                  {{ r.tipo }}
                </span>
              </td>
              <td><strong>{{ r.empleado_id }} - {{ r.empleado_nombre }}</strong></td>
              <td>{{ r.descripcion }}</td>
              <td class="amount">
                <strong>{{ r.tipo === 'Bono' ? '$' + (r.monto | number:'1.2-2') : r.horas + ' hrs' }}</strong>
              </td>
              <td>{{ r.fecha | date:'dd/MM/yyyy' }}</td>
              <td>
                <button class="btn-delete" (click)="eliminarRegistro(r.id, r.tipo)">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <p class="no-data" *ngIf="registros.length === 0">
      <i class="fas fa-inbox"></i> No hay registros aún
    </p>
  </section>

  <!-- MODAL CORREGIDO: oculto por defecto -->
<!-- MODAL DE ÉXITO BONITO (el que querías) -->
<div class="success-modal-overlay" 
     [style.display]="mostrarModalExito ? 'flex' : 'none'"
     (click)="cerrarModal()">
  
  <div class="success-modal" (click)="$event.stopPropagation()">
    <div class="success-modal-icon">
      <i class="fas fa-check"></i>
    </div>
    
    <h2>
      <span *ngIf="ultimaAccion === 'bono'">Bono asignado</span>
      <span *ngIf="ultimaAccion === 'hex'">Horas extras registradas</span>
      <br>
      <strong>correctamente</strong>
    </h2>
    
    <p class="success-subtitle">
      <span *ngIf="ultimaAccion === 'bono'">El bono se registró exitosamente en el sistema.</span>
      <span *ngIf="ultimaAccion === 'hex'">Las horas extras quedaron guardadas correctamente.</span>
    </p>
    
    <button class="success-btn" (click)="cerrarModal()">
      Aceptar
    </button>
  </div>
</div>
</main>